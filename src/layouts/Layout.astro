---
interface Props {
	title?: string;
	description?: string;
	image?: string;
}

const {
	title = "Iquitos Expedition - Tours al Amazonas Todo Incluido | Agencia Oficial",
	description = "Vive la mejor experiencia en la selva amazónica con Iquitos Expedition. Tours todo incluido, lodges en el Amazonas, pesca de pirañas, comunidades nativas y más. ¡Reserva hoy!",
	image = "https://iquitosexpedition.com/imagen_de_previsualizacion.avif",
} = Astro.props;

const canonicalURL = new URL(
	Astro.url.pathname,
	"https://iquitosexpedition.com",
);
const { url } = Astro;
const isContactPage = url.pathname.includes("contacts");

const schema = {
	"@context": "https://schema.org",
	"@type": "TravelAgency",
	name: "Iquitos Expedition",
	image: image,
	"@id": "https://iquitosexpedition.com",
	url: "https://iquitosexpedition.com",
	telephone: "+51968786482",
	priceRange: "$$",
	address: {
		"@type": "PostalAddress",
		streetAddress: "Iquitos",
		addressLocality: "Iquitos",
		addressRegion: "Loreto",
		postalCode: "16002",
		addressCountry: "PE",
	},
	geo: {
		"@type": "GeoCoordinates",
		latitude: -3.7436,
		longitude: -73.2516,
	},
	sameAs: [
		"https://www.facebook.com/iquitosexpedition",
		"https://www.instagram.com/iquitosexpedition",
		"https://www.tiktok.com/@iquitosexpedition",
	],
};

import "../styles/global.css";
import SpeedInsights from "@vercel/speed-insights/astro";
---

<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="sitemap" href="/sitemap-index.xml" />
		<meta name="robots" content="index, follow" />
		<meta name="author" content="Iquitos Expedition" />
		<meta
			name="copyright"
			content="Copyright (c) 2025, Iquitos Expedition"
		/>

		<title>{title}</title>
		<meta name="description" content={description} />
		<link rel="canonical" href={canonicalURL} />

		<meta property="og:site_name" content="Iquitos Expedition" />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={image} />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:type" content="website" />
		<meta property="og:image:width" content="1200" />
		<meta property="og:image:height" content="630" />
		<meta property="og:image:type" content="image/avif" />

		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={image} />

		<script type="application/ld+json" set:html={JSON.stringify(schema)} />

		<link
			rel="apple-touch-icon"
			sizes="180x180"
			href="/apple-touch-icon.png"
		/>
		<link
			rel="icon"
			type="image/png"
			sizes="32x32"
			href="/favicon-32x32.png"
		/>
		<link
			rel="icon"
			type="image/png"
			sizes="16x16"
			href="/favicon-16x16.png"
		/>
		<link rel="manifest" href="/site.webmanifest" />
		{
			isContactPage && (
				<script
					src="https://www.google.com/recaptcha/api.js"
					async
					defer
				/>
			)
		}
		<script defer>
			// Google Analytics
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				window.dataLayer.push(arguments);
			}
			gtag("js", new Date());
			gtag("config", "G-R3P2HY6LQP");
		</script>
	</head>
	<body>
		<div
			id="loader"
			class="fixed inset-0 flex items-center justify-center bg-white/30 backdrop-blur-xl z-50 transition-opacity duration-500"
			style="display: flex; position: fixed; inset: 0; z-index: 50; background-color: rgba(255, 255, 255, 0.3); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);"
		>
			<div
				class="w-12 h-12 border-4 border-t-orange-600 border-gray-300 rounded-full animate-spin"
			>
			</div>
		</div>
		<SpeedInsights />
		<slot />
		<a
			href="https://wa.link/no5uic"
			target="_blank"
			rel="noopener noreferrer"
			class="fixed bottom-6 right-6 z-30 w-16 h-16 bg-green-500 text-white rounded-full flex items-center justify-center shadow-xl hover:bg-green-600 transition duration-300 transform hover:scale-110"
			aria-label="Ir a Whatsapp"
		>
			<i class="fa-brands fa-whatsapp text-2xl"></i>
		</a>
	</body>
	<script>
		function hideLoader() {
			const loader = document.getElementById("loader");
			if (loader) {
				loader.style.opacity = "0";
				setTimeout(() => {
					loader.style.display = "none";
				}, 500);
			}
		}

		window.addEventListener("load", hideLoader);
		// Failsafe: Hide after 3 seconds anyway to prevent infinite loading
		setTimeout(hideLoader, 3000);
	</script>
</html>
